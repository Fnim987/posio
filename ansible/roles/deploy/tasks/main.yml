---
  - name: copy
    become: yes
    copy:
      src: kubedeploy.yaml
      dest: /home/ubuntu/kubedeploy.yaml
      
  - name: copy
    become: yes
    copy:
      src: kube.sh
      dest: /home/ubuntu/kube.sh

      
      
  - name: check the status of minikube.
    command: minikube status
    register: minikube_status
    changed_when: false
    ignore_errors: true

  - name: start minikube if it's not running.
    command: minikube start 
    when: "not minikube_status.stdout or 'Running' not in minikube_status.stdout"
      
  - name: start app
    shell: |
      sudo chmod +x kube.sh
      ./kube.sh
  

      